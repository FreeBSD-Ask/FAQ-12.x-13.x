# 13.1. 什么是沙盒？

"沙盒" 是一个安全术语。它可以意味着两件事:

- 一个进程被置于一套虚拟墙内，旨在防止闯入该进程的人能够闯入更广泛的系统。

该进程只能在墙内运行。由于进程在执行代码方面所做的任何事情都不可能突破围墙，因此不需要对其代码进行详细的审计，以便能够对其安全性进行某些说明。

例如，这些墙可能是一个用户的 ID。这是[security(7)](https://www.freebsd.org/cgi/man.cgi?query=security&sektion=7&format=html)和[named(8)](https://www.freebsd.org/cgi/man.cgi?query=named&sektion=8&format=html)man pages 中使用的定义。

以 `ntalk` 服务为例（见[inetd(8)](https://www.freebsd.org/cgi/man.cgi?query=inetd&sektion=8&format=html)）。这个服务曾经以用户 ID "root" 运行。现在它以用户 ID "tty" 运行。`tty` 用户是一个沙盒，旨在使通过 `ntalk` 成功入侵系统的人更难入侵到该用户的 ID 之外。

- 一个被置于机器的模拟内部的过程。这意味着，能够闯入该进程的人可能认为他能闯入更广泛的机器，但实际上只是闯入了该机器的模拟，而没有修改任何真实的数据。

最常见的方法是在一个子目录中建立一个模拟环境，然后在该目录中运行进程，使该进程的 **/** 是这个目录，而不是系统的真实 **/** ）。

另一个常见的用途是挂载一个底层文件系统为只读，然后在其上创建一个文件系统层，给进程提供一个似乎可以写入该文件系统的视图。该进程可能认为它能够写入这些文件，但只有该进程能看到这些效果--系统中的其他进程不一定。

试图使这种沙盒变得如此透明，以至于用户（或黑客）没有意识到他正坐在其中。

UNIX ®实现了两个核心沙盒。一个是在进程层面，一个是在用户 ID 层面。

每个 UNIX® 进程都与其他 UNIX® 进程完全隔绝。一个进程不能修改另一个进程的地址空间。

一个 UNIX® 进程是由一个特定的用户 ID所拥有。如果该用户 ID 不是 "root" 用户，它的作用是将该进程与其他用户拥有的进程隔离开来。用户 ID 也被用来对磁盘上的数据进行防火墙。
