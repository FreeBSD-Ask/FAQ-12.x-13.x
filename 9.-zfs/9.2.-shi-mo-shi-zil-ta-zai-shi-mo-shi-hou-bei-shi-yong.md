# 9.2. 什么是 ZIL，它在什么时候被使用？

ZIL（ ZFS 意图日志）是一个写日志，用于实现 posix 写承诺的跨崩溃语义。通常情况下，写被捆绑到事务组中，并在填满时写入磁盘（“事务组承诺”）。然而像 [fsync(2)](https://www.freebsd.org/cgi/man.cgi?query=fsync&sektion=2&format=html) 这样的系统调用需要一个承诺，即在返回之前将数据写入稳定的存储。对于那些已经被确认写入但尚未作为事务的一部分出现在磁盘上的写入，需要 ZIL。事务组是有时间戳的。在崩溃的情况下，最后一个有效的时间戳会被找到，缺失的数据会从 ZIL 中合并进来。
